[?1049h[1;47r(B[m[4l[?7h[?12l[?25h[?1h=[?1h=[?1h=[39;49m[39;49m(B[m[H[2J(B[0;7m  GNU nano 2.0.6     File: train_densenet121_multilabel_classification_all_classes.py                [3;1H(B[m# # Train finetunned SqueezeNet 2 model for multi-label classification[6dimport os[7dimport sys[8dfrom datetime import datetime[9dimport warnings[10dwarnings.filterwarnings("ignore")[13d# Project[14dproject_common_path = os.path.dirname(__file__)[15dproject_common_path = os.path.abspath(os.path.join(project_common_path, '..', 'common'))[16dif not project_common_path in sys.path:[17;5Hsys.path.append(project_common_path)[19dimport numpy as np[21dfrom data_utils import get_id_type_list_for_class, OUTPUT_PATH, GENERATED_DATA, to_set[22dfrom training_utils import classification_train as train, classification_validate as validate[23dfrom training_utils import exp_decay, step_decay[25dfrom models.densenet_multiclassification import get_densenet[27dfrom sklearn.model_selection import KFold[28dfrom data_utils import to_set, equalized_data_classes, unique_tags, train_jpg_ids, TRAIN_ENC_CL_CSV[29dfrom data_utils import load_pretrained_model, get_label[30dfrom data_utils import DataCache[32dfrom xy_providers import image_label_provider[33dfrom models.keras_metrics import binary_crossentropy_with_false_negatives[36dcnn = get_densenet(depth=121, input_shape=(224, 224, 3), n_classes=17, weights=None)[37dcnn.summary()[39d# Setup configuration[41dseed = 2017[42dnp.random.seed(seed)[44dtrainval_id_type_list = [(image_id, "Train_jpg") for image_id in train_jpg_ids][45;42H(B[0;7m[ Read 179 lines ][46d^G(B[m Get Help     (B[0;7m^O(B[m WriteOut     (B[0;7m^R(B[m Read File    (B[0;7m^Y(B[m Prev Page    (B[0;7m^K(B[m Cut Text     (B[0;7m^C(B[m Cur Pos[47d(B[0;7m^X(B[m Exit[47;17H(B[0;7m^J(B[m Justify[33G(B[0;7m^W(B[m Where Is     (B[0;7m^V(B[m Next Page    (B[0;7m^U(B[m UnCut Text   (B[0;7m^T(B[m To Spell[3d[45;25H(B[0;7m[ line 1/180 (0%), col 1/71 (1%), char 0/5641 (0%) ][3d(B[m[47;1H[?1049l[?1l>